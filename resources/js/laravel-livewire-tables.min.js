document.addEventListener("alpine:init",()=>{Alpine.data("tableWrapper",(e,t)=>({childElementOpen:!1,filtersOpen:e.entangle("filterSlideDownDefaultVisible"),paginationCurrentCount:e.entangle("paginationCurrentCount"),paginationTotalItemCount:e.entangle("paginationTotalItemCount"),paginationCurrentItems:e.entangle("paginationCurrentItems"),selectedItems:e.entangle("selected"),alwaysShowBulkActions:!e.entangle("hideBulkActionsWhenEmpty"),toggleSelectAll(){t&&(this.paginationTotalItemCount===this.selectedItems.length?this.clearSelected():this.setAllSelected())},setAllSelected(){t&&e.setAllSelected()},clearSelected(){t&&e.clearSelected()},selectAllOnPage(){if(!t)return;let e=this.selectedItems,i=this.paginationCurrentItems.values();for(let l of i)e.push(l.toString());this.selectedItems=[...new Set(e)]}})),Alpine.data("numberRangeFilter",(e,t,i,l,s)=>({allFilters:e.entangle("filterComponents",!1),originalMin:0,originalMax:100,filterMin:0,filterMax:100,currentMin:0,currentMax:100,hasUpdate:!1,wireValues:e.entangle("filterComponents."+t,!1),defaultMin:l.minRange,defaultMax:l.maxRange,restrictUpdates:!1,updateStyles(){let e=document.getElementById(i),t=document.getElementById(s+"-min"),l=document.getElementById(s+"-max");e.style.setProperty("--value-a",t.value),e.style.setProperty("--text-value-a",JSON.stringify(t.value)),e.style.setProperty("--value-b",l.value),e.style.setProperty("--text-value-b",JSON.stringify(l.value))},setupWire(){void 0!==this.wireValues?(this.filterMin=this.originalMin=void 0!==this.wireValues.min?this.wireValues.min:this.defaultMin,this.filterMax=this.originalMax=void 0!==this.wireValues.max?this.wireValues.max:this.defaultMax):(this.filterMin=this.originalMin=this.defaultMin,this.filterMax=this.originalMax=this.defaultMax),this.updateStyles()},allowUpdates(){this.updateWire()},updateWire(){let e=parseInt(this.filterMin),t=parseInt(this.filterMax);(e!=this.originalMin||t!=this.originalMax)&&(t<e&&(this.filterMin=t,this.filterMax=e),this.hasUpdate=!0,this.originalMin=e,this.originalMax=t),this.updateStyles()},updateWireable(){this.hasUpdate&&(this.hasUpdate=!1,this.wireValues={min:this.filterMin,max:this.filterMax},e.set("filterComponents."+t,this.wireValues))},init(){this.setupWire(),this.$watch("allFilters",e=>this.setupWire())}})),Alpine.data("flatpickrFilter",(e,t,i,l,s)=>({wireValues:e.entangle("filterComponents."+t),flatpickrInstance:flatpickr(l,{mode:"range",clickOpens:!0,allowInvalidPreload:!0,defaultDate:[],ariaDateFormat:i.ariaDateFormat,allowInput:i.allowInput,altFormat:i.altFormat,altInput:i.altInput,dateFormat:i.dateFormat,locale:"en",minDate:i.earliestDate,maxDate:i.latestDate,onOpen:function(){window.childElementOpen=!0},onChange:function(i,l,s){if(i.length>1){var n=l.split(" ")[0],a=l.split(" ")[2],r={};window.childElementOpen=!1,window.filterPopoverOpen=!1,r={minDate:n,maxDate:a},e.set("filterComponents."+t,r)}}}),setupWire(){if(void 0!==this.wireValues){if(void 0!==this.wireValues.minDate&&void 0!==this.wireValues.maxDate){let e=[this.wireValues.minDate,this.wireValues.maxDate];this.flatpickrInstance.setDate(e)}else this.flatpickrInstance.setDate([])}else this.flatpickrInstance.setDate([])},init(){this.setupWire(),this.$watch("wireValues",e=>this.setupWire())}})),Alpine.data("reorderFunction",(e,t,i)=>({dragging:!1,reorderEnabled:!1,sourceID:"",targetID:"",evenRowClasses:"",oddRowClasses:"",currentlyHighlightedElement:"",evenRowClassArray:{},oddRowClassArray:{},evenNotInOdd:{},oddNotInEven:{},orderedRows:[],defaultReorderColumn:e.get("defaultReorderColumn"),reorderStatus:e.get("reorderStatus"),currentlyReorderingStatus:e.entangle("currentlyReorderingStatus"),hideReorderColumnUnlessReorderingStatus:e.entangle("hideReorderColumnUnlessReorderingStatus"),reorderDisplayColumn:e.entangle("reorderDisplayColumn"),dragStart(e){this.sourceID=e.target.id,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",e.target.id),e.target.classList.add("laravel-livewire-tables-dragging")},dragOverEvent(e){"object"==typeof this.currentlyHighlightedElement&&this.currentlyHighlightedElement.classList.remove("laravel-livewire-tables-highlight-bottom","laravel-livewire-tables-highlight-top");let t=e.target.closest("tr");this.currentlyHighlightedElement=t,e.offsetY<t.getBoundingClientRect().height/2?(t.classList.add("laravel-livewire-tables-highlight-top"),t.classList.remove("laravel-livewire-tables-highlight-bottom")):(t.classList.remove("laravel-livewire-tables-highlight-top"),t.classList.add("laravel-livewire-tables-highlight-bottom"))},dragLeaveEvent(e){e.target.closest("tr").classList.remove("laravel-livewire-tables-highlight-bottom","laravel-livewire-tables-highlight-top")},dropEvent(e){"object"==typeof this.currentlyHighlightedElement&&this.currentlyHighlightedElement.classList.remove("laravel-livewire-tables-highlight-bottom","laravel-livewire-tables-highlight-top");let i=e.target.closest("tr"),l=e.target.closest("tr").parentNode,s=document.getElementById(this.sourceID).closest("tr");s.classList.remove("laravel-livewire-table-dragging");let n=s.rowIndex,a=i.rowIndex,r=document.getElementById(t),o=n;e.offsetY>i.getBoundingClientRect().height/2?l.insertBefore(s,i.nextSibling):l.insertBefore(s,i),a<n&&(o=a);let d="even";for(let h=1,u;u=r.rows[h];h++)u.classList.contains("hidden")||u.classList.contains("md:hidden")||("even"===d?(u.classList.remove(...this.oddNotInEven),u.classList.add(...this.evenNotInOdd),d="odd"):(u.classList.remove(...this.evenNotInOdd),u.classList.add(...this.oddNotInEven),d="even"))},reorderToggle(){this.currentlyReorderingStatus?e.disableReordering():(this.hideReorderColumnUnlessReorderingStatus&&(this.reorderDisplayColumn=!0),e.enableReordering())},cancelReorder(){this.hideReorderColumnUnlessReorderingStatus&&(this.reorderDisplayColumn=!1),e.disableReordering()},updateOrderedItems(){let l=document.getElementById(t),s=[];for(let n=1,a;a=l.rows[n];n++)s.push({[i]:a.getAttribute("rowpk"),[this.defaultReorderColumn]:n});e.storeReorder(s)},setupEvenOddClasses(){if(!0===this.currentlyReorderingStatus){let e=document.getElementById(t).getElementsByTagName("tbody")[0],i=[],l=[];void 0!==e.rows[0]&&void 0!==e.rows[1]&&(i=Array.from(e.rows[0].classList),l=Array.from(e.rows[1].classList),this.evenNotInOdd=i.filter(e=>!l.includes(e)),this.oddNotInEven=l.filter(e=>!i.includes(e)),i=[],l=[])}},init(){this.$watch("currentlyReorderingStatus",e=>this.setupEvenOddClasses())}})),Alpine.data("tableContextMenu",e=>({contextMenuOpen:!1,contextRowPrimaryKey:"",contextMenuToggle:function(e){let t=e.target.closest("tr").getAttribute("rowpk");if(null==t){this.contextMenuOpen=!1;return}this.contextRowPrimaryKey=t,this.contextMenuOpen=!0,e.preventDefault(),this.$refs.contextmenu.classList.add("opacity-0");let i=this;this.$nextTick(function(){i.calculateContextMenuPosition(e),i.calculateSubMenuPosition(e),i.$refs.contextmenu.classList.remove("opacity-0")})},calculateContextMenuPosition(e){window.innerHeight<e.clientY+this.$refs.contextmenu.offsetHeight?this.$refs.contextmenu.style.top=window.innerHeight-this.$refs.contextmenu.offsetHeight+"px":this.$refs.contextmenu.style.top=e.clientY+"px",window.innerWidth<e.clientX+this.$refs.contextmenu.offsetWidth?this.$refs.contextmenu.style.left=e.clientX-this.$refs.contextmenu.offsetWidth+"px":this.$refs.contextmenu.style.left=e.clientX+"px"},calculateSubMenuPosition(e){let t=document.querySelectorAll("[data-submenu]"),i=this.$refs.contextmenu.offsetWidth;for(let l=0;l<t.length;l++)if(window.innerWidth<e.clientX+i+t[l].offsetWidth?(t[l].classList.add("left-0","-translate-x-full"),t[l].classList.remove("right-0","translate-x-full")):(t[l].classList.remove("left-0","-translate-x-full"),t[l].classList.add("right-0","translate-x-full")),window.innerHeight<t[l].previousElementSibling.getBoundingClientRect().top+t[l].offsetHeight){let s=window.innerHeight-t[l].previousElementSibling.getBoundingClientRect().top-t[l].offsetHeight;t[l].style.top=s+"px"}else t[l].style.top=""},init(){this.$watch("contextMenuOpen",function(e){this.contextMenuIsEnabled?!0===e?document.body.classList.add("overflow-hidden"):document.body.classList.remove("overflow-hidden"):this.contextMenuOpen=!1}),window.addEventListener("resize",function(e){contextMenuOpen=!1})}}))});